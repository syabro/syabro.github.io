# Техническое задание на разработку прототипа игры на Unity3d

### Общее описание

Игра будет представлять собой тайм-менеджмент симулятор.

Аналоги:

- Дороги Рима
  http://www.nevosoft.ru/game-Roads-Of-Rome/platform-pc
- Tiny Tale
  http://www.bigfishgames.com/games/7711/the-tiny-tale/
  
Сеттинг: индустриальная эпоха. Заводы, банки, грузовики.

Игра ведется на карте с разметкой X*Y игровых блоков с размером блока ZxZ
Все координаты в конфигурационном файле указываются в данной размерности.

### Инструменты

Unity3D + C#

### Необходимый функционал прототипа

Игра загружает уровень из файла. Игрок может кликом на здания добавлять задания, которые выполняют грузовики и возвращаются на базу.

##### Парсинг уровня из yaml файла

Файл содержит:

1. Координаты базы игрока.
2. Координаты и тип прочих зданий
3. Схема дорог
4. Количество грузовиков игрока на базе

Пример

```yaml

headquarters:
  x: 1
  y: 2
  
buildings:
  - type: COAL_MINE
    x: 1
    y: 2
  - type: COAL_MINE
    x: 1
    y: 2
roads:
    - x1: 1
      y1: 1
      x2: 1
      y2: 10
trucks: 3


```
##### База
База представляет собой здание в котором изначально размещены грузовики игрока, и в которое они возвращаются после выполнения задания. Размещение аналогично остальным зданиям


##### Здания
Здания представляет собой 3d объект размером X*Y (например 3х2). Координаты здания указывают точку привязки к местности. К ней же будет подведена дорога. Например здание:
```
###
#X#
```

С координатами 5,5
Будет размещено в
```
  0123456789  
0 ..........
1 ..........
2 ..........
3 ..........
4 ....###...
5 ....#X#...
6 ..........
7 ..........
8 ..........

```

##### Дороги

Дороги представляют собой тайм по которому могут двигаться грузовики. Вне дорог грузовики двигаться не могут. 

*Примечание: в файле конфига уровня каждый элемент списка roads допускает указывает только вертикальное или горизонтальное размещение*

Тайл дороги должен выбираться автоматически в зависимости от прилегающих к данному тайлу.

Пример из другой игры: 
![](http://www.pixeljoint.com/files/icons/full/roads_tiles.png)

Так-же тайл должен считать точку размещения здания как другой тайл. Например в Transport Tycoon если к прямой дороге поставить Bus Stop, то тайл будет отображаться как у T-образного перекрестка

![](https://wiki.openttd.org/images/4/48/Tutorial_bus_4.png)

##### Грузовики

Грузовик представляет собой объект, который выполняет задания игрока. Грузовик может перемещаться только по дороге. В случае если грузовик оказался вне дороги его первоочередная задача — доехать до ближайшего тайла с дорогой.

Грузовик работает по следующему алгоритму.

1. Если задание не взято  
    1. Если есть задание в очереди заданий  
        3. Взять задание
        4. Начать выполнение
    5. Если нет заданий в очереди заданий
        6. Вернуться на базу
2. Если есть задание выполнять его.
3. Если задание было отменено во время выполнения - вернуться к п.1

Скорость движения грузовика ≈2 тайла в секунду.

##### Задания

В прототипе единственный тип задания будет
1. Доехать до здания
2. Подождать 3 секунды
3. Вернуться на базу

*Примечание: п.3 Вернуться на базу является частью задания. Таким образом задание считается невыполненным, пока грузовик не вернется на базу*

Задания добавляются в очередь заданий кликом на здание. После этого здание помечается маркером.

Задание можно отменить повторным кликом.

### Основные тесты:

1. Приложение успешно парсит файл и отображает игровое поле
1. Все типы перекрестков отображаются корректно
1. Все типы пересечений дороги со зданием отображаются корректно
1. По клику на здание оно помечается как добавленное в список заданий
1. После клика мышки со здания снимается маркер задания
1. По клику на здание выезжает грузовик из базы, едет в здание, ждет 3 секунды, едет обратно.
1. Грузовики не выезжают за пределы дороги
1. По клику на здание, грузовик выезжает и едет в сторону здания. При повторном нажатии на здании грузовик разворачивается и едет назад в штаб.
1. При нажатии последовательно на 3 здания из базы выезжают 3 грузовика
1. На базе 1 грузовик. При нажатии на 3 здания грузовик последовательно выполняет 3 задания с возвращением на базу после каждого здания.